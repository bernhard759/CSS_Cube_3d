<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --rotationXFrom: 0deg;
            --rotationYFrom: 0deg;
            --rotationXTo: 360deg;
            --rotationYTo: 360deg;
            margin: 1rem;
        }

        div {
            box-sizing: content-box;
        }

        .cube-div {
            position: relative;
            border-radius: 6px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            background-color: gainsboro;
            margin: auto;
            overflow: hidden;
            max-width: 550px;
            max-height: 550px;
            min-width: 250px;
            min-height: 250px;
            aspect-ratio: 1;
        }

        .cube-container {
            height: 50%;
            width: 50%;
            top: 25%;
            left: 25%;
            perspective: 800px;
            perspective-origin: center;
            background-color: transparent;
            position: absolute;
        }

        /* Cube */
        .cube {
            height: 100%;
            width: 100%;
            position: absolute;
            transform: translateZ(0);
            transform-style: preserve-3d;
            transition: transform 0.5s;
            will-change: transform;
        }

        /* Sides of the cube */
        .side {
            border: 2px solid slategray;
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: visible;
            backface-visibility: visible;
            cursor: default;
        }

        .side-content {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            padding: 1vmin;
            box-sizing: border-box;
        }

        .front {
            transform: translateZ(138px);
        }

        .back {
            transform: rotateX(180deg) translateZ(138px);
        }

        .left {
            transform: rotateY(-90deg) translateZ(138px);
        }

        .right {
            transform: rotateY(90deg) translateZ(138px);
        }

        .top {
            transform: rotateX(90deg) translateZ(138px);
        }

        .bot {
            transform: rotateX(-90deg) translateZ(138px);
        }


        /* Cube animation */
        @keyframes rotate {
            0% {
                transform: rotateX(var(--rotationXFrom)) rotateY(var(--rotationYFrom));
            }

            100% {
                transform: rotateX(var(--rotationXTo)) rotateY(var(--rotationYTo));
            }
        }
    </style>

    <style>
        /* Coords div */
        div.coords {
            width: -moz-fit-content;
            width: fit-content;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: x-small;
            display: none;
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 0.5vw;
            border-radius: 4px;

        }

        /* Form controls */
        .form-controls {
            position: relative;
            margin: auto;
            min-width: 250px;
            max-width: 550px;
            margin-top: 1rem;
            padding: 0.5rem;

        }
    </style>

    <style>
        /* Side contents spans*/
        .dice span {
            width: min(2.5em, 7.5vmin);
            height: min(2.5em, 7.5vmin);
            margin: auto;
        }

        span.point {
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 100%;
        }

        span.empty {
            background-color: transparent;
        }

        /* Dice grids */
        div.side-content div {
            width: 100%;
            height: 100%;
        }

        .dice.point-grid-1 {
            display: grid;
            margin: auto;
            gap: 1vmin;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .dice.point-grid-2 {
            display: grid;
            margin: auto;
            gap: 1vmin;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }

        .dice.point-grid-3 {
            display: grid;
            margin: auto;
            gap: 1vmin;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .dice.point-grid-4 {
            display: grid;
            margin: auto;
            gap: 1vmin;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }

        .dice.point-grid-5 {
            display: grid;
            margin: auto;
            gap: 1vmin;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .dice.point-grid-6 {
            display: grid;
            margin: 1vmin;
            gap: 1vmin;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        /* Display of side contents */
        .side-content span.text,
        .side-content span.number,
        .side-content div.dice {
            display: none;
        }
    </style>

    <style>
        /* Text */
        div.cube.text .side {
            background: rgba(30, 144, 255, 0.4);
        }

        div.cube.text .side-content span.text {
            display: block;
            font-size: min(5vw, 2em);
            color: rgba(0, 0, 0, 0.8);
        }

        /* Numbers */
        div.cube.numbers .side-content span.number {
            display: block;
            font-size: min(25vw, 4em);
            color: rgba(0, 0, 0, 0.8);
        }

        div.cube.numbers .side-content:nth-child(1) {
            background: rgba(34, 139, 34, 0.5);
        }

        div.cube.numbers .side:nth-child(2) .side-content {
            background: rgba(30, 144, 255, 0.5);
        }

        div.cube.numbers .side:nth-child(3) .side-content {
            background: rgba(102, 51, 153, 0.5);
        }

        div.cube.numbers .side:nth-child(4) .side-content {
            background: rgba(218, 165, 32, 0.5);
        }

        div.cube.numbers .side:nth-child(5) .side-content {
            background: rgba(255, 140, 0, 0.5);
        }

        div.cube.numbers .side:nth-child(6) .side-content {
            background: rgba(169, 169, 169, 0.5);
        }

        /* Dice */
        div.cube.dice .side {
            background-color: rgba(255, 255, 255, 0.75);
        }

        div.cube.dice .side-content div.dice {
            display: grid;
        }
    </style>
</head>

<body>
    <h1>CSS and JS 3D Cube Animation</h1>
    <br>
    <!-- Cube -->
    <div class="cube-div">
        <div class="cube-container">
            <div class="cube text">
                <div class="side front six">
                    <div class="side-content">
                        <span class="text">Front</span>
                        <span class="number">6</span>
                        <div class="dice point-grid-6">
                            <span class="point"></span>
                            <span class="point"></span>
                            <span class="point"></span>
                            <span class="point"></span>
                            <span class="point"></span>
                            <span class="point"></span>
                        </div>
                    </div>
                </div>
                <div class="side back one">
                    <div class="side-content">
                        <span class="text">Back</span>
                        <span class="number">1</span>
                        <div class="dice point-grid-1">
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                        </div>
                    </div>
                </div>
                <div class="side left four">
                    <div class="side-content">
                        <span class="text">Left</span>
                        <span class="number">4</span>
                        <div class="dice point-grid-4">
                            <span class="point"></span>
                            <span class="point"></span>
                            <span class="point"></span>
                            <span class="point"></span>
                        </div>
                    </div>
                </div>
                <div class="side right three">
                    <div class="side-content">
                        <span class="text">Right</span>
                        <span class="number">3</span>
                        <div class="dice point-grid-3">
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                        </div>
                    </div>
                </div>
                <div class="side top five">
                    <div class="side-content">
                        <span class="text">Top</span>
                        <span class="number">5</span>
                        <div class="dice point-grid-5">
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                        </div>
                    </div>
                </div>
                <div class="side bot two">
                    <div class="side-content">
                        <span class="text">Bottom</span>
                        <span class="number">2</span>
                        <div class="dice point-grid-2">
                            <span class="point"></span>
                            <span class="empty"></span>
                            <span class="empty"></span>
                            <span class="point"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="coords"><span></span></div>
    </div>
    <div class="form-controls">
        <hr>
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="animation-switch">
            <label class="form-check-label" for="animation-switch">Run animation</label>
        </div>
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="mouse-move-switch">
            <label class="form-check-label" for="mouse-move-switch">Enable Mousemove</label>
        </div>
        <hr>
        <input class="form-check-input" type="checkbox" value="" id="backface" checked>
        <label class="form-check-label" for="backface">
            Backface visibility
        </label><br>
        <input class="form-check-input" type="checkbox" value="" id="coords" disabled>
        <label class="form-check-label" for="coords">
            Show Coords box
        </label>
        <hr>
        <h6>Cube style</h6>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="radio-cube" id="option-text" checked>
            <label class="form-check-label" for="option-text">
                Default radio
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="radio-cube" id="option-numbers">
            <label class="form-check-label" for="option-numbers">
                Default checked radio
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="radio-cube" id="option-dice">
            <label class="form-check-label" for="option-dice">
                Default checked radio
            </label>
        </div>
    </div>

    <!-- Resize Observer -->
    <script>

        (function () {

            const cubeDiv = document.querySelector("div.cube-div");
            const translateRatio = cubeDiv.getBoundingClientRect().width / 138;
            console.log(translateRatio)
            /* Resize Observer object */

            const observer = new ResizeObserver(entries => {
                entries.forEach(entry => {
                    entry.target.querySelector(".front").style.transform = `translateZ(${entry.contentRect.width / translateRatio}px)`;
                    entry.target.querySelector(".back").style.transform = `rotateX(180deg) translateZ(${entry.contentRect.width / translateRatio}px)`;
                    entry.target.querySelector(".left").style.transform = `rotateY(-90deg) translateZ(${entry.contentRect.width / translateRatio}px)`;
                    entry.target.querySelector(".right").style.transform = `rotateY(90deg) translateZ(${entry.contentRect.width / translateRatio}px)`;
                    entry.target.querySelector(".top").style.transform = `rotateX(90deg) translateZ(${entry.contentRect.width / translateRatio}px)`;
                    entry.target.querySelector(".bot").style.transform = `rotateX(-90deg) translateZ(${entry.contentRect.width / translateRatio}px)`;
                })
            })

            /* Observe */
            observer.observe(document.querySelector(".cube-div"));

        })();

    </script>


    <!-- Controls -->
    <script>

        (function () {

            /* Config */
            let counter = 0;
            const updateRate = 10;

            /* HTML elements */
            const cubeDiv = document.querySelector(".cube-div");
            const cube = cubeDiv.querySelector(".cube")
            const animationSwitch = document.querySelector("#animation-switch");
            const mouseMoveSwitch = document.querySelector("#mouse-move-switch");
            const backfaceCheckbox = document.querySelector("#backface");
            const coordsCheckbox = document.querySelector("#coords");
            const coordsDiv = document.querySelector("div.coords")
            const radioText = document.querySelector("div.form-check #option-text")
            const radioNumbers = document.querySelector("div.form-check #option-numbers")
            const radioDice = document.querySelector("div.form-check #option-dice")


            /* Radiobuttons Eventlisteners */
            radioText?.addEventListener("change", function (e) {
                cube.classList.remove(cube.classList.item(1));
                cube.classList.add("text");
            })
            radioNumbers?.addEventListener("change", function (e) {
                cube.classList.remove(cube.classList.item(1));
                cube.classList.add("numbers");
            })
            radioDice?.addEventListener("change", function (e) {
                cube.classList.remove(cube.classList.item(1));
                cube.classList.add("dice");
            })

            /* Add Eventlistener to start animation */
            animationSwitch.addEventListener("change", function () {
                //console.log(animationSwitch.checked);
                if (animationSwitch.checked) {
                    cube.style.animation = "rotate 10s linear infinite";

                } else {
                    cube.style.animation = "none";

                }
            })


            /* Add Eventlistener for mouse move */
            mouseMoveSwitch.addEventListener("change", function () {
                //console.log(animationSwitch.checked);
                if (mouseMoveSwitch.checked) {
                    coordsCheckbox.disabled = false;
                } else {
                    coordsCheckbox.disabled = true;
                }
            })


            /* Add Eventlistener for backface visibility */
            backfaceCheckbox.addEventListener("change", function () {
                //console.log(backfaceCheckbox.checked);
                cube.querySelectorAll(".side")?.forEach((side) => {
                    if (backfaceCheckbox.checked) {
                        side.style.backfaceVisibility = "visible";
                    } else {
                        side.style.backfaceVisibility = "hidden";
                    }
                })
            })


            /* Add Eventlistener for coords div */
            coordsCheckbox.addEventListener("change", function () {
                if (!coordsCheckbox.checked) {
                    coordsDiv.style.display = "none";
                }
            })


            /* Mouse object */
            const mouse = {
                centerX: 0,
                centerY: 0,
                x: 0,
                y: 0,
                updatePosition: function (event) {
                    this.x = event.clientX - this.centerX;
                    this.y = -(event.clientY - this.centerY);
                },
                setCenter: function (element) {
                    this.centerX = element.offsetLeft + Math.floor(element.offsetWidth / 2);
                    this.centerY = element.offsetTop + Math.floor(element.offsetHeight / 2);
                },
            }
            mouse.setCenter(cubeDiv);


            /* Mouse enter */
            function onMouseEnter(event) {
                if (mouseMoveSwitch.checked) {
                    mouse.setCenter(cubeDiv);
                    cube.style.animation = "none"; // stop animation
                }
            };

            /* Mouse leave */
            function onMouseLeave() {
                if (mouseMoveSwitch.checked) {
                    cube.style.transform = "translateZ(10px)";
                    if (animationSwitch.checked) {
                        window.setTimeout(() => cube.style.animation = "rotate 10s linear infinite", 400);
                    }
                }
            };

            /* Mouse move */
            function onMouseMove(event) {
                /* Throttle update */
                if (Number.isInteger(counter++ / updateRate)) {
                    if (mouseMoveSwitch.checked) {
                        mouse.updatePosition(event);
                        cube.style.transform =
                            `rotateX(${(mouse.y / 10).toFixed(2)}deg) 
                         rotateY(${(mouse.x / 10).toFixed(2)}deg) translateZ(10px)`;
                        if (coordsCheckbox.checked) {
                            coordsDiv.firstChild.textContent = `${mouse.x}, ${mouse.y}`
                            coordsDiv.style.display = "block";
                        }
                    }
                }
            };

            /* Add Eventlisteners */
            cubeDiv.addEventListener("mouseenter", onMouseEnter)
            cubeDiv.addEventListener("mousemove", onMouseMove)
            cubeDiv.addEventListener("mouseleave", onMouseLeave)

        })();
        
    </script>

</body>

</html>